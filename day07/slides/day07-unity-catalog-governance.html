<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 7: Unity Catalog Security & Governance | Databricks Admin Training</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f1a 100%); min-height: 100vh; overflow: hidden; }
        .slide-container { width: 100vw; height: 100vh; color: #fff; }
        .slide { display: none; flex-direction: column; padding: 60px 80px; height: 100%; }
        .slide.active { display: flex; }
        .slide-title { font-size: 2.8em; font-weight: 700; margin-bottom: 40px; background: linear-gradient(135deg, #FF3621, #FF6B35); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .bullet-list { list-style: none; }
        .bullet-list li { font-size: 1.4em; margin-bottom: 20px; padding-left: 40px; position: relative; }
        .bullet-list li::before { content: "▸"; color: #FF3621; position: absolute; left: 0; }
        .bullet-list li.sub-item { font-size: 1.2em; margin-left: 40px; color: #ccc; }
        .bullet-list li.sub-item::before { content: "◦"; color: #FF6B35; }
        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-top: 30px; }
        .column-title { font-size: 1.4em; color: #FF6B35; margin-bottom: 20px; }
        .highlight-box { background: rgba(255, 54, 33, 0.1); border-left: 4px solid #FF3621; padding: 25px; margin: 20px 0; border-radius: 0 8px 8px 0; }
        .highlight-box p { font-size: 1.2em; }
        .progress-bar { position: fixed; bottom: 0; left: 0; height: 4px; background: linear-gradient(90deg, #FF3621, #FF6B35); }
        .slide-counter { position: fixed; bottom: 20px; right: 30px; color: #666; }
        .nav-hint { position: fixed; bottom: 20px; left: 30px; color: #444; font-size: 0.9em; }
        .title-slide { justify-content: center; align-items: center; text-align: center; }
        .title-slide .slide-title { font-size: 3.5em; margin-bottom: 20px; }
        .day-badge { background: linear-gradient(135deg, #FF3621, #FF6B35); color: white; padding: 10px 30px; border-radius: 25px; margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px 20px; text-align: left; border-bottom: 1px solid #333; }
        th { background: rgba(255, 54, 33, 0.2); color: #FF6B35; }
        .three-column { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 30px; }
        .info-card { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 25px; border: 1px solid #333; }
        .info-card h4 { color: #FF6B35; margin-bottom: 15px; }
        .info-card ul { list-style: none; }
        .info-card li { padding: 8px 0; border-bottom: 1px solid #333; }
        .info-card li:last-child { border-bottom: none; }
        .code-block { background: #0d1117; border: 1px solid #333; border-radius: 8px; padding: 20px; font-family: monospace; margin: 15px 0; font-size: 1.1em; }
        .warning-box { background: rgba(255, 193, 7, 0.1); border-left: 4px solid #ffc107; padding: 20px; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .warning-box p { font-size: 1.1em; color: #ffc107; }
        .privilege-flow { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 30px 0; flex-wrap: wrap; }
        .privilege-box { background: rgba(255, 107, 53, 0.2); border: 2px solid #FF6B35; border-radius: 8px; padding: 15px 25px; text-align: center; }
        .privilege-arrow { font-size: 1.5em; color: #FF3621; }
        .four-column { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 30px; }
    </style>
</head>
<body>
    <div class="slide-container">
        <!-- Slide 1: Title -->
        <div class="slide active title-slide">
            <div class="day-badge">Day 7 of 13</div>
            <h1 class="slide-title">Unity Catalog: Security & Governance</h1>
            <p style="font-size: 1.5em; color: #888;">Databricks Platform Administration Training</p>
            <p style="margin-top: 40px; color: #666;">Duration: 3 Hours</p>
        </div>

        <!-- Slide 2: Agenda -->
        <div class="slide">
            <h1 class="slide-title">Today's Agenda</h1>
            <ul class="bullet-list">
                <li>Privilege Model & Access Control (45 min)</li>
                <li>Permission Inheritance & Best Practices (30 min)</li>
                <li class="sub-item">Break (15 min)</li>
                <li>Data Lineage Concepts (30 min)</li>
                <li>Auditing & Governance Workflows (30 min)</li>
                <li>Hands-on Lab: Assign Permissions (60 min)</li>
            </ul>
        </div>

        <!-- Slide 3: Recap - Unity Catalog Architecture -->
        <div class="slide">
            <h1 class="slide-title">Recap: Unity Catalog Architecture</h1>
            <div class="privilege-flow">
                <div class="privilege-box" style="background: rgba(255,54,33,0.3);">METASTORE</div>
                <div class="privilege-arrow">→</div>
                <div class="privilege-box">CATALOG</div>
                <div class="privilege-arrow">→</div>
                <div class="privilege-box">SCHEMA</div>
                <div class="privilege-arrow">→</div>
                <div class="privilege-box" style="background: rgba(255,255,255,0.1);">TABLE/VIEW</div>
            </div>
            <div class="highlight-box">
                <p>Today we focus on <strong>securing</strong> this hierarchy with fine-grained permissions and governance controls.</p>
            </div>
        </div>

        <!-- Slide 4: Unity Catalog Privilege Model -->
        <div class="slide">
            <h1 class="slide-title">Unity Catalog Privilege Model</h1>
            <ul class="bullet-list">
                <li><strong>SQL-based</strong> – GRANT and REVOKE statements</li>
                <li><strong>Hierarchical inheritance</strong> – Permissions flow down</li>
                <li><strong>Fine-grained</strong> – Table, column, and row level</li>
                <li><strong>Identity-aware</strong> – Users, groups, service principals</li>
                <li><strong>Centralized</strong> – Single place to manage all permissions</li>
            </ul>
        </div>

        <!-- Slide 5: Securable Objects -->
        <div class="slide">
            <h1 class="slide-title">Securable Objects</h1>
            <div class="three-column">
                <div class="info-card">
                    <h4>Container Objects</h4>
                    <ul>
                        <li>Metastore</li>
                        <li>Catalog</li>
                        <li>Schema</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>Data Objects</h4>
                    <ul>
                        <li>Table</li>
                        <li>View</li>
                        <li>Volume</li>
                        <li>Function</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>Storage Objects</h4>
                    <ul>
                        <li>Storage Credential</li>
                        <li>External Location</li>
                        <li>Connection</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 6: Available Privileges -->
        <div class="slide">
            <h1 class="slide-title">Available Privileges</h1>
            <table>
                <tr>
                    <th>Privilege</th>
                    <th>Description</th>
                    <th>Applies To</th>
                </tr>
                <tr>
                    <td>SELECT</td>
                    <td>Read data from table/view</td>
                    <td>Table, View</td>
                </tr>
                <tr>
                    <td>MODIFY</td>
                    <td>Insert, update, delete data</td>
                    <td>Table</td>
                </tr>
                <tr>
                    <td>CREATE</td>
                    <td>Create child objects</td>
                    <td>Catalog, Schema</td>
                </tr>
                <tr>
                    <td>USAGE</td>
                    <td>Access container (required to access children)</td>
                    <td>Catalog, Schema</td>
                </tr>
                <tr>
                    <td>ALL PRIVILEGES</td>
                    <td>All applicable privileges</td>
                    <td>Any object</td>
                </tr>
            </table>
        </div>

        <!-- Slide 7: GRANT Syntax -->
        <div class="slide">
            <h1 class="slide-title">GRANT Syntax</h1>
            <div class="code-block">
-- Grant SELECT on a table<br>
GRANT SELECT ON TABLE catalog.schema.table TO `user@company.com`;<br><br>
-- Grant to a group<br>
GRANT SELECT, MODIFY ON TABLE catalog.schema.table TO `data_engineers`;<br><br>
-- Grant on schema (affects all current and future tables)<br>
GRANT USAGE ON SCHEMA catalog.schema TO `analysts`;<br>
GRANT SELECT ON SCHEMA catalog.schema TO `analysts`;<br><br>
-- Grant catalog-level access<br>
GRANT USAGE ON CATALOG catalog_name TO `team_group`;
            </div>
        </div>

        <!-- Slide 8: REVOKE Syntax -->
        <div class="slide">
            <h1 class="slide-title">REVOKE Syntax</h1>
            <div class="code-block">
-- Revoke SELECT from user<br>
REVOKE SELECT ON TABLE catalog.schema.table FROM `user@company.com`;<br><br>
-- Revoke all privileges<br>
REVOKE ALL PRIVILEGES ON TABLE catalog.schema.table FROM `user@company.com`;<br><br>
-- View current grants<br>
SHOW GRANTS ON TABLE catalog.schema.table;<br><br>
-- Show grants for a user<br>
SHOW GRANTS TO `user@company.com`;
            </div>
        </div>

        <!-- Slide 9: Permission Inheritance -->
        <div class="slide">
            <h1 class="slide-title">Permission Inheritance</h1>
            <div class="highlight-box">
                <p><strong>Key Concept:</strong> Permissions granted at a higher level automatically apply to all child objects.</p>
            </div>
            <ul class="bullet-list" style="margin-top: 20px;">
                <li>USAGE on catalog → can access all schemas</li>
                <li>SELECT on schema → can read all tables in schema</li>
                <li>CREATE on schema → can create tables, views, functions</li>
                <li>Inheritance simplifies administration</li>
                <li>But requires careful planning!</li>
            </ul>
        </div>

        <!-- Slide 10: USAGE Requirement -->
        <div class="slide">
            <h1 class="slide-title">The USAGE Requirement</h1>
            <div class="warning-box">
                <p>⚠️ <strong>Important:</strong> To access any object, users need USAGE on ALL parent containers.</p>
            </div>
            <div class="code-block">
-- This alone is NOT enough:<br>
GRANT SELECT ON TABLE catalog.schema.employees TO `analyst`;<br><br>
-- User also needs:<br>
GRANT USAGE ON CATALOG catalog TO `analyst`;<br>
GRANT USAGE ON SCHEMA catalog.schema TO `analyst`;
            </div>
            <p style="margin-top: 20px; font-size: 1.2em;">USAGE acts as a "gatekeeper" - without it, users cannot even see the child objects.</p>
        </div>

        <!-- Slide 11: Ownership -->
        <div class="slide">
            <h1 class="slide-title">Object Ownership</h1>
            <ul class="bullet-list">
                <li><strong>Owner</strong> has full control over an object</li>
                <li>Creator becomes the default owner</li>
                <li>Owners can GRANT/REVOKE permissions</li>
                <li>Owners can DROP objects</li>
                <li>Ownership can be transferred</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Transfer ownership<br>
ALTER TABLE catalog.schema.table SET OWNER TO `new_owner@company.com`;<br><br>
-- Check current owner<br>
DESCRIBE EXTENDED catalog.schema.table;
            </div>
        </div>

        <!-- Slide 12: Admin Roles -->
        <div class="slide">
            <h1 class="slide-title">Administrative Roles</h1>
            <div class="three-column">
                <div class="info-card">
                    <h4>Metastore Admin</h4>
                    <ul>
                        <li>Manage metastore settings</li>
                        <li>Create catalogs</li>
                        <li>Manage storage credentials</li>
                        <li>Assign metastore to workspaces</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>Account Admin</h4>
                    <ul>
                        <li>Create metastores</li>
                        <li>Manage account users</li>
                        <li>Configure identity federation</li>
                        <li>Assign metastore admins</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>Workspace Admin</h4>
                    <ul>
                        <li>Manage workspace users</li>
                        <li>Configure workspace settings</li>
                        <li>Cannot modify Unity Catalog</li>
                        <li>Local admin scope only</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 13: Security Best Practices -->
        <div class="slide">
            <h1 class="slide-title">Security Best Practices</h1>
            <ul class="bullet-list">
                <li><strong>Principle of least privilege</strong> – Grant minimum needed</li>
                <li><strong>Use groups</strong> – Never grant to individual users</li>
                <li><strong>Leverage inheritance</strong> – Set permissions at schema level</li>
                <li><strong>Regular audits</strong> – Review permissions periodically</li>
                <li><strong>Document policies</strong> – Maintain access request workflows</li>
                <li><strong>Test before production</strong> – Validate in dev environment</li>
            </ul>
        </div>

        <!-- Slide 14: Column-Level Security -->
        <div class="slide">
            <h1 class="slide-title">Column-Level Security</h1>
            <div class="highlight-box">
                <p>Restrict access to specific columns within a table using <strong>column masks</strong> or <strong>views</strong>.</p>
            </div>
            <div class="code-block">
-- Create a view that masks sensitive columns<br>
CREATE VIEW catalog.schema.customers_masked AS<br>
SELECT<br>
&nbsp;&nbsp;customer_id,<br>
&nbsp;&nbsp;name,<br>
&nbsp;&nbsp;CASE WHEN is_member_of('pii_viewers')<br>
&nbsp;&nbsp;&nbsp;&nbsp;THEN email<br>
&nbsp;&nbsp;&nbsp;&nbsp;ELSE '***MASKED***'<br>
&nbsp;&nbsp;END AS email<br>
FROM catalog.schema.customers;
            </div>
        </div>

        <!-- Slide 15: Row-Level Security -->
        <div class="slide">
            <h1 class="slide-title">Row-Level Security</h1>
            <div class="highlight-box">
                <p>Filter rows based on user identity using <strong>row filters</strong> or <strong>views</strong>.</p>
            </div>
            <div class="code-block">
-- Create view with row-level filtering<br>
CREATE VIEW catalog.schema.sales_by_region AS<br>
SELECT * FROM catalog.schema.sales<br>
WHERE region IN (<br>
&nbsp;&nbsp;SELECT region FROM catalog.schema.user_regions<br>
&nbsp;&nbsp;WHERE user_email = current_user()<br>
);
            </div>
        </div>

        <!-- Slide 16: Dynamic Views -->
        <div class="slide">
            <h1 class="slide-title">Dynamic Views for Security</h1>
            <ul class="bullet-list">
                <li><strong>current_user()</strong> – Returns current user's email</li>
                <li><strong>is_member_of('group')</strong> – Check group membership</li>
                <li><strong>is_account_group_member('group')</strong> – Account-level group</li>
                <li>Combine for complex access patterns</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Dynamic row and column filtering<br>
CREATE VIEW secure_data AS<br>
SELECT<br>
&nbsp;&nbsp;id, public_field,<br>
&nbsp;&nbsp;CASE WHEN is_member_of('admins') THEN secret_field ELSE NULL END as secret_field<br>
FROM raw_data<br>
WHERE department = (SELECT dept FROM user_departments WHERE email = current_user());
            </div>
        </div>

        <!-- Slide 17: Data Lineage -->
        <div class="slide">
            <h1 class="slide-title">Data Lineage</h1>
            <div class="highlight-box">
                <p><strong>Data Lineage</strong> automatically tracks how data flows through transformations, from source to destination.</p>
            </div>
            <ul class="bullet-list" style="margin-top: 20px;">
                <li>Captured automatically for Unity Catalog objects</li>
                <li>Shows upstream sources (where data came from)</li>
                <li>Shows downstream dependents (what uses this data)</li>
                <li>Tracks notebooks, jobs, and SQL queries</li>
                <li>Visual representation in Data Explorer</li>
            </ul>
        </div>

        <!-- Slide 18: Lineage Use Cases -->
        <div class="slide">
            <h1 class="slide-title">Lineage Use Cases</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">Impact Analysis</div>
                    <ul class="bullet-list">
                        <li>What downstream uses this table?</li>
                        <li>Who will be affected by schema changes?</li>
                        <li>Which reports depend on this data?</li>
                    </ul>
                </div>
                <div>
                    <div class="column-title">Root Cause Analysis</div>
                    <ul class="bullet-list">
                        <li>Where did this data come from?</li>
                        <li>What transformations were applied?</li>
                        <li>Which job created this anomaly?</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 19: Viewing Lineage -->
        <div class="slide">
            <h1 class="slide-title">Viewing Lineage in Data Explorer</h1>
            <ul class="bullet-list">
                <li>Navigate to <strong>Catalog</strong> in sidebar</li>
                <li>Select a table or view</li>
                <li>Click the <strong>Lineage</strong> tab</li>
                <li>Explore upstream and downstream relationships</li>
                <li>Click nodes to see details</li>
            </ul>
            <div class="highlight-box" style="margin-top: 20px;">
                <p><strong>Tip:</strong> Lineage is captured at query execution time. Run queries to populate lineage graph.</p>
            </div>
        </div>

        <!-- Slide 20: Lineage API -->
        <div class="slide">
            <h1 class="slide-title">Programmatic Lineage Access</h1>
            <div class="code-block">
-- Query system table for lineage<br>
SELECT * FROM system.access.table_lineage<br>
WHERE target_table_full_name = 'catalog.schema.table_name';<br><br>
-- Column-level lineage<br>
SELECT * FROM system.access.column_lineage<br>
WHERE target_table_full_name = 'catalog.schema.table_name';
            </div>
            <p style="margin-top: 20px; font-size: 1.1em;">System tables provide programmatic access to lineage data for custom reporting and automation.</p>
        </div>

        <!-- Slide 21: Audit Logging -->
        <div class="slide">
            <h1 class="slide-title">Audit Logging</h1>
            <div class="highlight-box">
                <p><strong>Unity Catalog Audit Logs</strong> record all access and administrative actions for compliance and security monitoring.</p>
            </div>
            <ul class="bullet-list" style="margin-top: 20px;">
                <li>Data access events (SELECT, MODIFY)</li>
                <li>Administrative actions (GRANT, REVOKE, CREATE, DROP)</li>
                <li>Authentication events</li>
                <li>Delivered to cloud storage or SIEM</li>
            </ul>
        </div>

        <!-- Slide 22: Audit Log Events -->
        <div class="slide">
            <h1 class="slide-title">Key Audit Events</h1>
            <table>
                <tr>
                    <th>Event Category</th>
                    <th>Examples</th>
                </tr>
                <tr>
                    <td>Data Access</td>
                    <td>getTable, getTableData, generateTemporaryTableCredential</td>
                </tr>
                <tr>
                    <td>Permission Changes</td>
                    <td>updatePermissions, getPermissions</td>
                </tr>
                <tr>
                    <td>Object Management</td>
                    <td>createCatalog, createSchema, createTable, deleteTable</td>
                </tr>
                <tr>
                    <td>Metastore Admin</td>
                    <td>createMetastore, updateMetastoreAssignment</td>
                </tr>
            </table>
        </div>

        <!-- Slide 23: Accessing Audit Logs -->
        <div class="slide">
            <h1 class="slide-title">Accessing Audit Logs</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">Via System Tables</div>
                    <div class="code-block">
-- Query audit logs<br>
SELECT<br>
&nbsp;&nbsp;event_time,<br>
&nbsp;&nbsp;action_name,<br>
&nbsp;&nbsp;user_identity,<br>
&nbsp;&nbsp;request_params<br>
FROM system.access.audit<br>
WHERE event_date >= current_date() - 7;
                    </div>
                </div>
                <div>
                    <div class="column-title">Via Cloud Delivery</div>
                    <ul class="bullet-list">
                        <li>Configure in Account Console</li>
                        <li>Deliver to S3/ADLS/GCS</li>
                        <li>JSON format</li>
                        <li>Near real-time delivery</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 24: Governance Workflows -->
        <div class="slide">
            <h1 class="slide-title">Governance Workflows</h1>
            <div class="four-column">
                <div class="info-card">
                    <h4>1. Access Request</h4>
                    <ul>
                        <li>User submits request</li>
                        <li>Specify data needed</li>
                        <li>Business justification</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>2. Approval</h4>
                    <ul>
                        <li>Data owner reviews</li>
                        <li>Security team validates</li>
                        <li>Compliance check</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>3. Provisioning</h4>
                    <ul>
                        <li>Add user to group</li>
                        <li>GRANT permission</li>
                        <li>Set expiration</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>4. Audit</h4>
                    <ul>
                        <li>Monitor usage</li>
                        <li>Regular review</li>
                        <li>Revoke if unused</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 25: Tags and Classification -->
        <div class="slide">
            <h1 class="slide-title">Tags and Classification</h1>
            <ul class="bullet-list">
                <li><strong>Tags</strong> provide metadata for data classification</li>
                <li>Apply to catalogs, schemas, tables, columns</li>
                <li>Use for PII identification, data sensitivity</li>
                <li>Enable policy-based governance</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Set a tag on a column<br>
ALTER TABLE catalog.schema.customers<br>
ALTER COLUMN email SET TAGS ('pii' = 'email');<br><br>
-- View tags<br>
SELECT * FROM system.information_schema.column_tags<br>
WHERE table_name = 'customers';
            </div>
        </div>

        <!-- Slide 26: Information Schema -->
        <div class="slide">
            <h1 class="slide-title">Information Schema Queries</h1>
            <div class="code-block">
-- List all tables in a schema<br>
SELECT * FROM system.information_schema.tables<br>
WHERE table_schema = 'my_schema';<br><br>
-- View column details<br>
SELECT * FROM system.information_schema.columns<br>
WHERE table_name = 'my_table';<br><br>
-- Check grants on objects<br>
SELECT * FROM system.information_schema.table_privileges<br>
WHERE grantee = 'data_analysts';
            </div>
        </div>

        <!-- Slide 27: Common Permission Patterns -->
        <div class="slide">
            <h1 class="slide-title">Common Permission Patterns</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">Read-Only Analysts</div>
                    <div class="code-block" style="font-size: 0.9em;">
GRANT USAGE ON CATALOG prod TO analysts;<br>
GRANT USAGE ON SCHEMA prod.reporting TO analysts;<br>
GRANT SELECT ON SCHEMA prod.reporting TO analysts;
                    </div>
                </div>
                <div>
                    <div class="column-title">Data Engineers</div>
                    <div class="code-block" style="font-size: 0.9em;">
GRANT USAGE ON CATALOG prod TO engineers;<br>
GRANT ALL PRIVILEGES ON SCHEMA prod.raw TO engineers;<br>
GRANT ALL PRIVILEGES ON SCHEMA prod.processed TO engineers;
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 28: Troubleshooting Permissions -->
        <div class="slide">
            <h1 class="slide-title">Troubleshooting Permissions</h1>
            <ul class="bullet-list">
                <li><strong>"Permission denied"</strong> – Check USAGE on all parents</li>
                <li><strong>Cannot see object</strong> – Verify USAGE on catalog and schema</li>
                <li><strong>Cannot modify</strong> – Need MODIFY privilege, not just SELECT</li>
                <li><strong>Cannot create</strong> – Need CREATE on parent container</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Debug: Show all grants for a user<br>
SHOW GRANTS TO `problem_user@company.com`;<br><br>
-- Debug: Show grants on specific object<br>
SHOW GRANTS ON TABLE catalog.schema.table;
            </div>
        </div>

        <!-- Slide 29: Lab Introduction -->
        <div class="slide">
            <h1 class="slide-title">Hands-On Lab: Permissions & Governance</h1>
            <div class="highlight-box">
                <p><strong>Duration:</strong> 60 minutes</p>
            </div>
            <ul class="bullet-list">
                <li>Create groups for different roles</li>
                <li>Grant permissions using GRANT/REVOKE</li>
                <li>Test permission inheritance</li>
                <li>Create secure views with dynamic filtering</li>
                <li>Explore data lineage</li>
                <li>Query audit logs</li>
            </ul>
            <div class="highlight-box" style="margin-top: 20px;">
                <p><strong>Lab Guide:</strong> LAB_07_Permissions_Governance.md</p>
            </div>
        </div>

        <!-- Slide 30: Summary -->
        <div class="slide">
            <h1 class="slide-title">Day 7 Summary</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">Key Concepts</div>
                    <ul class="bullet-list">
                        <li>GRANT/REVOKE SQL syntax</li>
                        <li>USAGE requirement for containers</li>
                        <li>Permission inheritance</li>
                        <li>Column and row-level security</li>
                    </ul>
                </div>
                <div>
                    <div class="column-title">Governance Features</div>
                    <ul class="bullet-list">
                        <li>Automatic data lineage</li>
                        <li>Comprehensive audit logging</li>
                        <li>Tags for classification</li>
                        <li>System tables for reporting</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 31: What's Next -->
        <div class="slide">
            <h1 class="slide-title">Coming Up: Day 8</h1>
            <div class="highlight-box">
                <p><strong>IAM, SCIM & Identity Integration</strong></p>
            </div>
            <ul class="bullet-list">
                <li>Identity federation deep dive</li>
                <li>SCIM provisioning setup</li>
                <li>SSO configuration</li>
                <li>Service principal management</li>
            </ul>
        </div>

        <!-- Slide 32: Thank You -->
        <div class="slide title-slide">
            <h1 class="slide-title">Thank You!</h1>
            <p style="font-size: 1.5em; color: #888;">See you on Day 8</p>
        </div>
    </div>

    <div class="progress-bar" id="progressBar"></div>
    <div class="slide-counter" id="slideCounter">1 / 32</div>
    <div class="nav-hint">← → Navigate | N: Notes</div>

    <script>
        const slides = document.querySelectorAll('.slide');
        let currentSlide = 0;
        function showSlide(n) {
            if (n < 0) n = 0; if (n >= slides.length) n = slides.length - 1;
            slides.forEach(s => s.classList.remove('active'));
            slides[n].classList.add('active');
            currentSlide = n;
            document.getElementById('progressBar').style.width = ((n + 1) / slides.length) * 100 + '%';
            document.getElementById('slideCounter').textContent = `${n + 1} / ${slides.length}`;
        }
        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight' || e.key === ' ') showSlide(currentSlide + 1);
            else if (e.key === 'ArrowLeft') showSlide(currentSlide - 1);
        });
        document.addEventListener('click', e => {
            e.clientX > window.innerWidth / 2 ? showSlide(currentSlide + 1) : showSlide(currentSlide - 1);
        });
        showSlide(0);
    </script>
</body>
</html>
