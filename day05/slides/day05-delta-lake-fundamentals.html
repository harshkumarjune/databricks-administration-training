<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 5: Delta Lake Fundamentals | Databricks Admin Training</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f1a 100%); min-height: 100vh; overflow: hidden; }
        .slide-container { width: 100vw; height: 100vh; display: flex; flex-direction: column; color: #ffffff; }
        .slide { display: none; flex-direction: column; justify-content: flex-start; padding: 60px 80px; height: 100%; animation: fadeIn 0.5s ease-in-out; }
        .slide.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .slide-title { font-size: 2.8em; font-weight: 700; margin-bottom: 40px; background: linear-gradient(135deg, #FF3621, #FF6B35); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .bullet-list { list-style: none; }
        .bullet-list li { font-size: 1.4em; margin-bottom: 20px; padding-left: 40px; position: relative; opacity: 0; transform: translateX(-30px); transition: all 0.5s ease; }
        .bullet-list li.visible { opacity: 1; transform: translateX(0); }
        .bullet-list li::before { content: "▸"; color: #FF3621; position: absolute; left: 0; }
        .bullet-list li.sub-item { font-size: 1.2em; margin-left: 40px; color: #ccc; }
        .bullet-list li.sub-item::before { content: "◦"; color: #FF6B35; }
        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-top: 30px; }
        .column-title { font-size: 1.4em; color: #FF6B35; margin-bottom: 20px; font-weight: 600; }
        .highlight-box { background: rgba(255, 54, 33, 0.1); border-left: 4px solid #FF3621; padding: 25px; margin: 20px 0; border-radius: 0 8px 8px 0; }
        .highlight-box p { font-size: 1.2em; line-height: 1.6; }
        .progress-bar { position: fixed; bottom: 0; left: 0; height: 4px; background: linear-gradient(90deg, #FF3621, #FF6B35); transition: width 0.3s ease; }
        .slide-counter { position: fixed; bottom: 20px; right: 30px; font-size: 1em; color: #666; }
        .nav-hint { position: fixed; bottom: 20px; left: 30px; font-size: 0.9em; color: #444; }
        .title-slide { justify-content: center; align-items: center; text-align: center; }
        .title-slide .slide-title { font-size: 3.5em; margin-bottom: 20px; }
        .day-badge { background: linear-gradient(135deg, #FF3621, #FF6B35); color: white; padding: 10px 30px; border-radius: 25px; font-size: 1.2em; margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px 20px; text-align: left; border-bottom: 1px solid #333; }
        th { background: rgba(255, 54, 33, 0.2); color: #FF6B35; }
        .three-column { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 30px; }
        .info-card { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 25px; border: 1px solid #333; }
        .info-card h4 { color: #FF6B35; margin-bottom: 15px; }
        .info-card ul { list-style: none; }
        .info-card li { padding: 8px 0; border-bottom: 1px solid #333; }
        .info-card li:last-child { border-bottom: none; }
        .code-block { background: #0d1117; border: 1px solid #333; border-radius: 8px; padding: 20px; font-family: monospace; font-size: 1.1em; margin: 15px 0; }
        .architecture-flow { display: flex; align-items: center; justify-content: center; gap: 20px; margin: 30px 0; }
        .arch-box { background: rgba(255, 255, 255, 0.05); border: 2px solid #FF3621; border-radius: 12px; padding: 20px 25px; text-align: center; }
        .arch-box h4 { color: #FF6B35; margin-bottom: 8px; }
        .arrow { font-size: 1.5em; color: #FF3621; }
    </style>
</head>
<body>
    <div class="slide-container">
        <!-- Slide 1: Title -->
        <div class="slide active title-slide">
            <div class="day-badge">Day 5 of 13</div>
            <h1 class="slide-title">Delta Lake Fundamentals</h1>
            <p style="font-size: 1.5em; color: #888;">Databricks Platform Administration Training</p>
            <p style="margin-top: 40px; color: #666;">Duration: 3 Hours | Virtual Instructor-Led</p>
        </div>

        <!-- Slide 2: Agenda -->
        <div class="slide">
            <h1 class="slide-title">Today's Agenda</h1>
            <ul class="bullet-list">
                <li>Delta Lake Architecture (45 min)</li>
                <li>ACID Transactions & Versioning (30 min)</li>
                <li class="sub-item">Break (15 min)</li>
                <li>Time Travel & Admin Implications (30 min)</li>
                <li>Hands-on Lab: Inspect Delta Tables (60 min)</li>
            </ul>
        </div>

        <!-- Slide 3: Learning Objectives -->
        <div class="slide">
            <h1 class="slide-title">Learning Objectives</h1>
            <ul class="bullet-list">
                <li>Understand Delta Lake architecture and transaction log</li>
                <li>Explain ACID properties and their importance</li>
                <li>Use time travel for data recovery and auditing</li>
                <li>Manage table versions and retention policies</li>
                <li>Optimize Delta tables for performance</li>
            </ul>
        </div>

        <!-- Slide 4: Section Header -->
        <div class="slide title-slide">
            <div class="day-badge">Section 1</div>
            <h1 class="slide-title">Delta Lake Architecture</h1>
            <p style="font-size: 1.5em; color: #888;">The foundation of the Lakehouse</p>
        </div>

        <!-- Slide 5: What is Delta Lake? -->
        <div class="slide">
            <h1 class="slide-title">What is Delta Lake?</h1>
            <div class="highlight-box">
                <p><strong>Delta Lake</strong> is an open-source storage layer that brings ACID transactions to data lakes, enabling reliable data pipelines and consistent reads/writes.</p>
            </div>
            <ul class="bullet-list" style="margin-top: 30px;">
                <li>Built on Parquet files (columnar storage)</li>
                <li>Transaction log for atomic operations</li>
                <li>Schema enforcement and evolution</li>
                <li>Time travel capabilities</li>
                <li>Unified batch and streaming</li>
            </ul>
        </div>

        <!-- Slide 6: Delta Lake Components -->
        <div class="slide">
            <h1 class="slide-title">Delta Lake Components</h1>
            <div class="architecture-flow">
                <div class="arch-box"><h4>Data Files</h4><p>Parquet format</p></div>
                <div class="arrow">+</div>
                <div class="arch-box"><h4>Transaction Log</h4><p>_delta_log/</p></div>
                <div class="arrow">=</div>
                <div class="arch-box"><h4>Delta Table</h4><p>ACID + Time Travel</p></div>
            </div>
            <ul class="bullet-list" style="margin-top: 30px;">
                <li><strong>Data Files:</strong> Parquet files containing actual data</li>
                <li><strong>Transaction Log:</strong> JSON files tracking all changes</li>
                <li><strong>Checkpoints:</strong> Periodic snapshots of log state</li>
            </ul>
        </div>

        <!-- Slide 7: Transaction Log -->
        <div class="slide">
            <h1 class="slide-title">The Transaction Log (_delta_log/)</h1>
            <div class="code-block">
table_name/<br>
├── _delta_log/<br>
│   ├── 00000000000000000000.json<br>
│   ├── 00000000000000000001.json<br>
│   ├── 00000000000000000002.json<br>
│   └── 00000000000000000010.checkpoint.parquet<br>
├── part-00000-xxxx.parquet<br>
└── part-00001-xxxx.parquet
            </div>
            <ul class="bullet-list" style="margin-top: 20px;">
                <li>Each JSON file = one transaction (commit)</li>
                <li>Checkpoints every 10 commits for faster reads</li>
                <li>Log is the single source of truth</li>
            </ul>
        </div>

        <!-- Slide 8: Section Header -->
        <div class="slide title-slide">
            <div class="day-badge">Section 2</div>
            <h1 class="slide-title">ACID Transactions & Versioning</h1>
            <p style="font-size: 1.5em; color: #888;">Reliability for data lakes</p>
        </div>

        <!-- Slide 9: ACID Properties -->
        <div class="slide">
            <h1 class="slide-title">ACID Properties</h1>
            <table>
                <tr><th>Property</th><th>Meaning</th><th>Delta Lake Implementation</th></tr>
                <tr><td><strong>Atomicity</strong></td><td>All or nothing</td><td>Transaction log commits</td></tr>
                <tr><td><strong>Consistency</strong></td><td>Valid state only</td><td>Schema enforcement</td></tr>
                <tr><td><strong>Isolation</strong></td><td>Concurrent operations don't interfere</td><td>Optimistic concurrency</td></tr>
                <tr><td><strong>Durability</strong></td><td>Committed data persists</td><td>Cloud storage persistence</td></tr>
            </table>
        </div>

        <!-- Slide 10: Schema Enforcement -->
        <div class="slide">
            <h1 class="slide-title">Schema Enforcement & Evolution</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">Schema Enforcement</div>
                    <ul class="bullet-list">
                        <li>Rejects writes that don't match schema</li>
                        <li>Prevents data corruption</li>
                        <li>Default behavior</li>
                    </ul>
                </div>
                <div>
                    <div class="column-title">Schema Evolution</div>
                    <ul class="bullet-list">
                        <li>Allows schema changes</li>
                        <li>mergeSchema option</li>
                        <li>Add columns safely</li>
                    </ul>
                </div>
            </div>
            <div class="code-block" style="margin-top: 20px;">
# Enable schema evolution on write<br>
df.write.option("mergeSchema", "true").mode("append").saveAsTable("my_table")
            </div>
        </div>

        <!-- Slide 11: Section Header -->
        <div class="slide title-slide">
            <div class="day-badge">Section 3</div>
            <h1 class="slide-title">Time Travel & Admin Implications</h1>
            <p style="font-size: 1.5em; color: #888;">Query historical data</p>
        </div>

        <!-- Slide 12: Time Travel -->
        <div class="slide">
            <h1 class="slide-title">Time Travel Capabilities</h1>
            <ul class="bullet-list">
                <li><strong>Query by version:</strong> SELECT * FROM table VERSION AS OF 5</li>
                <li><strong>Query by timestamp:</strong> SELECT * FROM table TIMESTAMP AS OF '2024-01-01'</li>
                <li><strong>Restore:</strong> RESTORE TABLE table TO VERSION AS OF 3</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Query historical data<br>
SELECT * FROM my_table VERSION AS OF 10;<br><br>
-- Restore table to previous version<br>
RESTORE TABLE my_table TO VERSION AS OF 5;
            </div>
        </div>

        <!-- Slide 13: Retention & Vacuum -->
        <div class="slide">
            <h1 class="slide-title">Retention & VACUUM</h1>
            <div class="highlight-box">
                <p><strong>VACUUM</strong> removes data files no longer referenced by the transaction log. Default retention: 7 days.</p>
            </div>
            <ul class="bullet-list" style="margin-top: 20px;">
                <li><strong>delta.deletedFileRetentionDuration:</strong> Default 7 days</li>
                <li><strong>VACUUM removes:</strong> Old data files only</li>
                <li><strong>VACUUM keeps:</strong> Transaction log files</li>
            </ul>
            <div class="code-block">
-- Remove files older than 7 days (default)<br>
VACUUM my_table;<br><br>
-- Custom retention (use with caution)<br>
VACUUM my_table RETAIN 168 HOURS;
            </div>
        </div>

        <!-- Slide 14: Admin Implications -->
        <div class="slide">
            <h1 class="slide-title">Admin Implications of Time Travel</h1>
            <table>
                <tr><th>Consideration</th><th>Impact</th><th>Admin Action</th></tr>
                <tr><td>Storage costs</td><td>Historical versions use storage</td><td>Set appropriate retention</td></tr>
                <tr><td>Data recovery</td><td>Can restore accidental deletes</td><td>Train users on RESTORE</td></tr>
                <tr><td>Auditing</td><td>Can query point-in-time</td><td>Use DESCRIBE HISTORY</td></tr>
                <tr><td>Compliance</td><td>Retention vs deletion requirements</td><td>Balance with regulations</td></tr>
            </table>
        </div>

        <!-- Slide 15: Table Optimization -->
        <div class="slide">
            <h1 class="slide-title">Delta Table Optimization</h1>
            <ul class="bullet-list">
                <li><strong>OPTIMIZE:</strong> Compacts small files into larger ones</li>
                <li><strong>Z-ORDER:</strong> Co-locates related data for faster queries</li>
                <li><strong>Auto Optimize:</strong> Automatic file compaction</li>
            </ul>
            <div class="code-block" style="margin-top: 20px;">
-- Compact small files<br>
OPTIMIZE my_table;<br><br>
-- Compact with Z-ordering on column<br>
OPTIMIZE my_table ZORDER BY (date, region);
            </div>
        </div>

        <!-- Slide 16: Lab Introduction -->
        <div class="slide">
            <h1 class="slide-title">Hands-On Lab: Inspect Delta Tables</h1>
            <div class="highlight-box">
                <p><strong>Duration:</strong> 60 minutes</p>
            </div>
            <ul class="bullet-list">
                <li>Create Delta tables and examine structure</li>
                <li>View transaction history with DESCRIBE HISTORY</li>
                <li>Practice time travel queries</li>
                <li>Run VACUUM and understand retention</li>
                <li>Optimize tables with OPTIMIZE command</li>
            </ul>
            <div class="highlight-box" style="margin-top: 20px;">
                <p><strong>Lab Guide:</strong> LAB_05_Delta_Tables.md</p>
            </div>
        </div>

        <!-- Slide 17: Summary -->
        <div class="slide">
            <h1 class="slide-title">Day 5 Summary</h1>
            <div class="two-column">
                <div>
                    <div class="column-title">What We Covered</div>
                    <ul class="bullet-list">
                        <li>Delta Lake architecture</li>
                        <li>Transaction log and ACID</li>
                        <li>Time travel capabilities</li>
                        <li>VACUUM and retention</li>
                    </ul>
                </div>
                <div>
                    <div class="column-title">Key Takeaways</div>
                    <ul class="bullet-list">
                        <li>Delta = Parquet + Transaction Log</li>
                        <li>ACID enables reliable pipelines</li>
                        <li>Time travel for recovery & audit</li>
                        <li>VACUUM manages storage costs</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 18: Quiz -->
        <div class="slide">
            <h1 class="slide-title">Day 5 Quiz</h1>
            <div class="highlight-box">
                <p><strong>10 Questions | 10 Minutes | 70% to Pass</strong></p>
            </div>
            <div class="highlight-box" style="margin-top: 30px;">
                <p><strong>Quiz File:</strong> day05_quiz.md</p>
            </div>
        </div>

        <!-- Slide 19: What's Next -->
        <div class="slide">
            <h1 class="slide-title">Coming Up: Day 6</h1>
            <div class="highlight-box">
                <p><strong>Unity Catalog: Architecture & Setup</strong></p>
            </div>
            <ul class="bullet-list">
                <li>Unity Catalog architecture</li>
                <li>Metastore, catalogs, schemas, tables</li>
                <li>Centralized governance model</li>
                <li>Hands-on: Configure Unity Catalog</li>
            </ul>
        </div>

        <!-- Slide 20: Thank You -->
        <div class="slide title-slide">
            <h1 class="slide-title">Thank You!</h1>
            <p style="font-size: 1.5em; color: #888;">See you on Day 6</p>
        </div>
    </div>

    <div class="progress-bar" id="progressBar"></div>
    <div class="slide-counter" id="slideCounter">1 / 20</div>
    <div class="nav-hint">← → Navigate | Home/End: First/Last</div>

    <script>
        const slides = document.querySelectorAll('.slide');
        let currentSlide = 0;
        function showSlide(index) {
            if (index < 0) index = 0;
            if (index >= slides.length) index = slides.length - 1;
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) { slide.classList.add('active'); animateBullets(slide); }
            });
            currentSlide = index;
            document.getElementById('progressBar').style.width = ((currentSlide + 1) / slides.length) * 100 + '%';
            document.getElementById('slideCounter').textContent = `${currentSlide + 1} / ${slides.length}`;
        }
        function animateBullets(slide) {
            slide.querySelectorAll('.bullet-list li').forEach((bullet, i) => {
                bullet.classList.remove('visible');
                setTimeout(() => bullet.classList.add('visible'), 150 * i);
            });
        }
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') showSlide(currentSlide + 1);
            else if (e.key === 'ArrowLeft') showSlide(currentSlide - 1);
            else if (e.key === 'Home') showSlide(0);
            else if (e.key === 'End') showSlide(slides.length - 1);
        });
        document.addEventListener('click', (e) => {
            if (e.clientX > window.innerWidth / 2) showSlide(currentSlide + 1);
            else showSlide(currentSlide - 1);
        });
        showSlide(0);
    </script>
</body>
</html>
